@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import common.Strings
@import config.FrontendAppConfig
@import models.ExistingProtectionDisplayModel
@import play.api.i18n._
@import views.HeaderContent
@import views.html.playHelpers.templates.existingProtections.protectionDetails

@this(appConfig: FrontendAppConfig)

@(protection: ExistingProtectionDisplayModel, statusGroup: String, protectionNum: Int)(implicit messages: Messages)

@changeLink = {
    @protection.amendCall.map{ call =>
        <a class="govuk-link" href="@call" id=@{s"${protection.status.toLowerCase}-${Strings.protectionTypeString(Some(protection.protectionType))}-amend-link-$protectionNum"}>
            @Messages("pla.existingProtections.amendLinkText")
            <span class="govuk-visually-hidden">
                @Messages("pla.protection.types." + protection.protectionType) @protection.protectionReference
            </span>
        </a>
    }
}

<dl class="govuk-summary-list">
    @protection.protectedAmount.map { protectedAmount =>
        @protectionDetails(Messages(HeaderContent.getProtectedLifetimeAllowance), protectedAmount, s"${protection.status}InactiveProtectedAmount$protectionNum", Some(changeLink))
    }

    @protectionDetails(Messages(HeaderContent.getProtectionNotificatioNumber), protection.protectionReference, s"${protection.status}InactiveProtectionReference$protectionNum")

    @protection.psaCheckReference.map { checkRef =>
        @protectionDetails(Messages(HeaderContent.getSchemeAdministratorReference), checkRef, s"${protection.status}InactivePSACheckRef$protectionNum")
    }

    @protection.certificateDate.map{ certificateDate =>
        @protectionDetails(Messages("pla.existingProtections.applicationDate"), certificateDate, s"${protection.status}InactiveCertificateDate$protectionNum")
    }

    @protection.certificateTime.map{ certificateTime =>
        @protectionDetails(Messages("pla.existingProtections.applicationTime"), certificateTime, s"${protection.status}InactiveCertificateTime$protectionNum")
    }

    @protection.withdrawnDate.map{ withdrawnDate =>
        @protectionDetails(Messages("pla.existingProtections.withdrawnDate"), withdrawnDate, s"${protection.status}InactiveWithdrawnDate$protectionNum")
    }

    @protection.lumpSumPercentage.map { lumpSumPercentage =>
        @protectionDetails(Messages("pla.existingProtections.lumpSumPercentage"), lumpSumPercentage, s"${protection.status}InactiveLumpSumPercentage$protectionNum")
    }

    @protection.lumpSumAmount.map{ lumpSumAmount =>
        @protectionDetails(Messages("pla.existingProtections.lumpSumAmount"), lumpSumAmount, s"${protection.status}InactiveLumpSumAmount$protectionNum")
    }

    @protection.enhancementFactor.map{ enhancementFactor =>
        @protectionDetails(Messages("pla.existingProtections.enhancementFactor"), enhancementFactor, s"${protection.status}EnhancementFactor$protectionNum")
    }

    @protection.factor.map{ factor =>
        @protectionDetails(Messages("pla.existingProtections.factor"), factor, s"${protection.status}Factor$protectionNum")
    }

</dl>


